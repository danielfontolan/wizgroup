<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Wizgroup - Inspetor de Mensagens do Chatwoot</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 15px; }
        h3 { border-bottom: 1px solid #ccc; padding-bottom: 10px; }
        pre { 
            background-color: #f0f0f0; 
            border: 1px solid #ccc; 
            padding: 10px; 
            white-space: pre-wrap; 
            word-wrap: break-word; 
            font-family: 'Courier New', Courier, monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>

    <h3>Inspetor de Mensagens do Chatwoot</h3>
    <p>Esta página irá registrar todas as mensagens recebidas do Chatwoot abaixo.</p>
    <pre id="log-output">Aguardando mensagens...</pre>

    <script>
        const logOutput = document.getElementById('log-output');
        let messageCount = 0;

        // Limpa a mensagem inicial
        logOutput.textContent = 'Ouvindo...\n\n';

        window.addEventListener('message', function(event) {
            // Filtro de segurança essencial
            if (event.origin !== "https://chat.wizgroup.com.br") {
                return;
            }

            messageCount++;
            
            let logText = `--- MENSAGEM RECEBIDA #${messageCount} ---\n`;
            logText += `Origem: ${event.origin}\n`;
            logText += `Dado Bruto (Tipo: ${typeof event.data}):\n${event.data}\n\n`;
            
            // Tenta formatar como JSON para melhor visualização, se possível
            try {
                const parsedData = JSON.parse(event.data);
                logText += `Dado Formatado como Objeto JSON:\n${JSON.stringify(parsedData, null, 2)}\n`;
            } catch (e) {
                logText += `(O dado recebido não é um JSON válido.)\n`;
            }

            logText += '-----------------------------------\n\n';
            
            // Adiciona o log na tela, em vez do console
            logOutput.textContent += logText;
        });
    </script>
</body>
</html>
